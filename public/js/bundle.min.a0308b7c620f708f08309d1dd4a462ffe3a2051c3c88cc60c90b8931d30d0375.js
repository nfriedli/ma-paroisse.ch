(function(global,factory){typeof exports=="object"&&typeof module!="undefined"?module.exports=factory():typeof define=="function"&&define.amd?define(factory):(global=global||self,global.Fuse=factory())})(this,function(){'use strict';function _typeof(obj){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(obj){return typeof obj}:_typeof=function(obj){return obj&&typeof Symbol=="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(i=0;i<props.length;i++){var i,descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(i=1;i<arguments.length;i++){var i,source=arguments[i]!=null?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _inherits(subClass,superClass){if(typeof superClass!="function"&&superClass!==null)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _isNativeReflectConstruct(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _assertThisInitialized(self){if(self===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _possibleConstructorReturn(self,call){return call&&(typeof call=="object"||typeof call=="function")?call:_assertThisInitialized(self)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _iterableToArray(iter){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o=="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){(len==null||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function isArray(value){return Array.isArray?Array.isArray(value):getTag(value)==="[object Array]"}var INFINITY=1/0;function baseToString(value){if(typeof value=="string")return value;var result=value+'';return result=="0"&&1/value==-INFINITY?"-0":result}function toString(value){return value==null?'':baseToString(value)}function isString(value){return typeof value=="string"}function isNumber(value){return typeof value=="number"}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&getTag(value)=="[object Boolean]"}function isObject(value){return _typeof(value)==="object"}function isObjectLike(value){return isObject(value)&&value!==null}function isDefined(value){return value!==void 0&&value!==null}function isBlank(value){return!value.trim().length}function getTag(value){return value==null?value===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(value)}var EXTENDED_SEARCH_UNAVAILABLE="Extended search is not available",INCORRECT_INDEX_TYPE="Incorrect 'index' type",LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY=function(key){return"Invalid value for key ".concat(key)},PATTERN_LENGTH_TOO_LARGE=function(max){return"Pattern length exceeds max of ".concat(max,".")},MISSING_KEY_PROPERTY=function(name){return"Missing ".concat(name," property in key")},INVALID_KEY_WEIGHT_VALUE=function(key){return"Property 'weight' in key '".concat(key,"' must be a positive integer")},hasOwn=Object.prototype.hasOwnProperty,KeyStore=function(){function KeyStore(keys){var _this=this;_classCallCheck(this,KeyStore),this._keys=[],this._keyMap={};var totalWeight=0;keys.forEach(function(key){var obj=createKey(key);totalWeight+=obj.weight,_this._keys.push(obj),_this._keyMap[obj.id]=obj,totalWeight+=obj.weight}),this._keys.forEach(function(key){key.weight/=totalWeight})}return _createClass(KeyStore,[{key:"get",value:function(keyId){return this._keyMap[keyId]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),KeyStore}();function createKey(key){var path=null;id=null,src=null;var id,src,weight=1;if(isString(key)||isArray(key))src=key,path=createKeyPath(key),id=createKeyId(key);else{if(!hasOwn.call(key,"name"))throw new Error(MISSING_KEY_PROPERTY("name"));var name=key.name;if(src=name,hasOwn.call(key,"weight"))if(weight=key.weight,weight<=0)throw new Error(INVALID_KEY_WEIGHT_VALUE(name));path=createKeyPath(name),id=createKeyId(name)}return{path,id,weight,src}}function createKeyPath(key){return isArray(key)?key:key.split(".")}function createKeyId(key){return isArray(key)?key.join("."):key}function get(obj,path){var list=[];var deepGet=function deepGet(obj,path,index){if(!isDefined(obj))return;if(path[index]){var value=obj[key],key=path[index];if(!isDefined(value))return;if(index===path.length-1&&(isString(value)||isNumber(value)||isBoolean(value)))list.push(toString(value));else if(isArray(value)){arr=!0;for(var i=0,len=value.length;i<len;i+=1)deepGet(value[i],path,index+1)}else path.length&&deepGet(value,path,index+1)}else list.push(obj)},arr=!1;return deepGet(obj,isString(path)?path.split("."):path,0),arr?list:list[0]}var MatchOptions={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},BasicOptions={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(a,b){return a.score===b.score?a.idx<b.idx?-1:1:a.score<b.score?-1:1}},FuzzyOptions={location:0,threshold:.6,distance:100},AdvancedOptions={useExtendedSearch:!1,getFn:get,ignoreLocation:!1,ignoreFieldNorm:!1},Config=_objectSpread2({},BasicOptions,{},MatchOptions,{},FuzzyOptions,{},AdvancedOptions),SPACE=/[^ ]+/g;function norm(){var mantissa=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,cache=new Map,m=Math.pow(10,mantissa);return{get:function(value){var numTokens=value.match(SPACE).length,n;if(cache.has(numTokens))return cache.get(numTokens);var norm=1/Math.sqrt(numTokens);return n=parseFloat(Math.round(norm*m)/m),cache.set(numTokens,n),n},clear:function(){cache.clear()}}}var FuseIndex=function(){function FuseIndex(){var _ref=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_ref$getFn=_ref.getFn,getFn=_ref$getFn===void 0?Config.getFn:_ref$getFn;_classCallCheck(this,FuseIndex),this.norm=norm(3),this.getFn=getFn,this.isCreated=!1,this.setIndexRecords()}return _createClass(FuseIndex,[{key:"setSources",value:function(){var docs=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=docs}},{key:"setIndexRecords",value:function(){var records=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=records}},{key:"setKeys",value:function(){var _this=this,keys=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=keys,this._keysMap={},keys.forEach(function(key,idx){_this._keysMap[key.id]=idx})}},{key:"create",value:function(){var _this2=this;if(this.isCreated||!this.docs.length)return;this.isCreated=!0,isString(this.docs[0])?this.docs.forEach(function(doc,docIndex){_this2._addString(doc,docIndex)}):this.docs.forEach(function(doc,docIndex){_this2._addObject(doc,docIndex)}),this.norm.clear()}},{key:"add",value:function(doc){var idx=this.size();isString(doc)?this._addString(doc,idx):this._addObject(doc,idx)}},{key:"removeAt",value:function(idx){this.records.splice(idx,1);for(var i=idx,len=this.size();i<len;i+=1)this.records[i].i-=1}},{key:"getValueForItemAtKeyId",value:function(item,keyId){return item[this._keysMap[keyId]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(doc,docIndex){if(!isDefined(doc)||isBlank(doc))return;var record={v:doc,i:docIndex,n:this.norm.get(doc)};this.records.push(record)}},{key:"_addObject",value:function(doc,docIndex){var _this3=this,record={i:docIndex,$:{}};this.keys.forEach(function(key,keyIndex){var value=_this3.getFn(doc,key.path);if(!isDefined(value))return;if(isArray(value))(function(){for(var subRecords=[],stack=[{nestedArrIndex:-1,value}];stack.length;){var _stack$pop=stack.pop(),nestedArrIndex=_stack$pop.nestedArrIndex,_value=_stack$pop.value;if(!isDefined(_value))continue;if(isString(_value)&&!isBlank(_value)){var subRecord={v:_value,i:nestedArrIndex,n:_this3.norm.get(_value)};subRecords.push(subRecord)}else isArray(_value)&&_value.forEach(function(item,k){stack.push({nestedArrIndex:k,value:item})})}record.$[keyIndex]=subRecords})();else if(!isBlank(value)){var subRecord={v:value,n:_this3.norm.get(value)};record.$[keyIndex]=subRecord}}),this.records.push(record)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),FuseIndex}();function createIndex(keys,docs){var _ref2=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_ref2$getFn=_ref2.getFn,getFn=_ref2$getFn===void 0?Config.getFn:_ref2$getFn,myIndex=new FuseIndex({getFn});return myIndex.setKeys(keys.map(createKey)),myIndex.setSources(docs),myIndex.create(),myIndex}function parseIndex(data){var _ref3=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_ref3$getFn=_ref3.getFn,getFn=_ref3$getFn===void 0?Config.getFn:_ref3$getFn,keys=data.keys,records=data.records,myIndex=new FuseIndex({getFn});return myIndex.setKeys(keys),myIndex.setIndexRecords(records),myIndex}function computeScore(pattern){var _ref=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_ref$errors=_ref.errors,errors=_ref$errors===void 0?0:_ref$errors,_ref$currentLocation=_ref.currentLocation,currentLocation=_ref$currentLocation===void 0?0:_ref$currentLocation,_ref$expectedLocation=_ref.expectedLocation,expectedLocation=_ref$expectedLocation===void 0?0:_ref$expectedLocation,_ref$distance=_ref.distance,distance=_ref$distance===void 0?Config.distance:_ref$distance,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=_ref$ignoreLocation===void 0?Config.ignoreLocation:_ref$ignoreLocation,accuracy=errors/pattern.length;if(ignoreLocation)return accuracy;var proximity=Math.abs(expectedLocation-currentLocation);return distance?accuracy+proximity/distance:proximity?1:accuracy}function convertMaskToIndices(){for(var matchmask=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],minMatchCharLength=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Config.minMatchCharLength,indices=[],start=-1,end=-1,i=0,len=matchmask.length;i<len;i+=1){var match=matchmask[i];match&&start===-1?start=i:!match&&start!==-1&&(end=i-1,end-start+1>=minMatchCharLength&&indices.push([start,end]),start=-1)}return matchmask[i-1]&&i-start>=minMatchCharLength&&indices.push([start,i-1]),indices}var MAX_BITS=32;function search(text,pattern,patternAlphabet){var _ref=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_ref$location=_ref.location,location=_ref$location===void 0?Config.location:_ref$location,_ref$distance=_ref.distance,distance=_ref$distance===void 0?Config.distance:_ref$distance,_ref$threshold=_ref.threshold,threshold=_ref$threshold===void 0?Config.threshold:_ref$threshold,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=_ref$findAllMatches===void 0?Config.findAllMatches:_ref$findAllMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=_ref$minMatchCharLeng===void 0?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$includeMatches=_ref.includeMatches,includeMatches=_ref$includeMatches===void 0?Config.includeMatches:_ref$includeMatches,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=_ref$ignoreLocation===void 0?Config.ignoreLocation:_ref$ignoreLocation,index,i,_i,j;if(pattern.length>MAX_BITS)throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));for(var patternLen=pattern.length,textLen=text.length,expectedLocation=Math.max(0,Math.min(location,textLen)),currentThreshold=threshold,bestLocation=expectedLocation,computeMatches=minMatchCharLength>1||includeMatches,matchMask=computeMatches?Array(textLen):[];(index=text.indexOf(pattern,bestLocation))>-1;){var score=computeScore(pattern,{currentLocation:index,expectedLocation,distance,ignoreLocation});if(currentThreshold=Math.min(score,currentThreshold),bestLocation=index+patternLen,computeMatches)for(i=0;i<patternLen;)matchMask[index+i]=1,i+=1}bestLocation=-1;var lastBitArr=[],finalScore=1,binMax=patternLen+textLen,mask=1<<patternLen-1;for(_i=0;_i<patternLen;_i+=1){for(var binMin=0,binMid=binMax;binMin<binMid;){var _score2=computeScore(pattern,{errors:_i,currentLocation:expectedLocation+binMid,expectedLocation,distance,ignoreLocation});_score2<=currentThreshold?binMin=binMid:binMax=binMid,binMid=Math.floor((binMax-binMin)/2+binMin)}binMax=binMid;var start=Math.max(1,expectedLocation-binMid+1),finish=findAllMatches?textLen:Math.min(expectedLocation+binMid,textLen)+patternLen,bitArr=Array(finish+2);bitArr[finish+1]=(1<<_i)-1;for(j=finish;j>=start;j-=1){var currentLocation=j-1,charMatch=patternAlphabet[text.charAt(currentLocation)];if(computeMatches&&(matchMask[currentLocation]=+!!charMatch),bitArr[j]=(bitArr[j+1]<<1|1)&charMatch,_i&&(bitArr[j]|=(lastBitArr[j+1]|lastBitArr[j])<<1|1|lastBitArr[j+1]),bitArr[j]&mask)if(finalScore=computeScore(pattern,{errors:_i,currentLocation,expectedLocation,distance,ignoreLocation}),finalScore<=currentThreshold){if(currentThreshold=finalScore,bestLocation=currentLocation,bestLocation<=expectedLocation)break;start=Math.max(1,2*expectedLocation-bestLocation)}}var _score=computeScore(pattern,{errors:_i+1,currentLocation:expectedLocation,expectedLocation,distance,ignoreLocation});if(_score>currentThreshold)break;lastBitArr=bitArr}var result={isMatch:bestLocation>=0,score:Math.max(.001,finalScore)};if(computeMatches){var indices=convertMaskToIndices(matchMask,minMatchCharLength);indices.length?includeMatches&&(result.indices=indices):result.isMatch=!1}return result}function createPatternAlphabet(pattern){var mask={};for(var i=0,len=pattern.length;i<len;i+=1){var char=pattern.charAt(i);mask[char]=(mask[char]||0)|1<<len-i-1}return mask}var BitapSearch=function(){function BitapSearch(pattern){var _this=this,_ref=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_ref$location=_ref.location,location=_ref$location===void 0?Config.location:_ref$location,_ref$threshold=_ref.threshold,threshold=_ref$threshold===void 0?Config.threshold:_ref$threshold,_ref$distance=_ref.distance,distance=_ref$distance===void 0?Config.distance:_ref$distance,_ref$includeMatches=_ref.includeMatches,includeMatches=_ref$includeMatches===void 0?Config.includeMatches:_ref$includeMatches,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=_ref$findAllMatches===void 0?Config.findAllMatches:_ref$findAllMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=_ref$minMatchCharLeng===void 0?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$isCaseSensitive=_ref.isCaseSensitive,isCaseSensitive=_ref$isCaseSensitive===void 0?Config.isCaseSensitive:_ref$isCaseSensitive,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=_ref$ignoreLocation===void 0?Config.ignoreLocation:_ref$ignoreLocation,len,i,end;if(_classCallCheck(this,BitapSearch),this.options={location,threshold,distance,includeMatches,findAllMatches,minMatchCharLength,isCaseSensitive,ignoreLocation},this.pattern=isCaseSensitive?pattern:pattern.toLowerCase(),this.chunks=[],!this.pattern.length)return;var addChunk=function(pattern,startIndex){_this.chunks.push({pattern,alphabet:createPatternAlphabet(pattern),startIndex})};if(len=this.pattern.length,len>MAX_BITS){{i=0;var remainder=len%MAX_BITS;for(end=len-remainder;i<end;)addChunk(this.pattern.substr(i,MAX_BITS),i),i+=MAX_BITS;if(remainder){var startIndex=len-MAX_BITS;addChunk(this.pattern.substr(startIndex),startIndex)}}}else addChunk(this.pattern,0)}return _createClass(BitapSearch,[{key:"searchIn",value:function(text){var _this$options=this.options,isCaseSensitive=_this$options.isCaseSensitive,includeMatches=_this$options.includeMatches;if(isCaseSensitive||(text=text.toLowerCase()),this.pattern===text){var _result={isMatch:!0,score:0};return includeMatches&&(_result.indices=[[0,text.length-1]]),_result}var _this$options2=this.options,location=_this$options2.location,distance=_this$options2.distance,threshold=_this$options2.threshold,findAllMatches=_this$options2.findAllMatches,minMatchCharLength=_this$options2.minMatchCharLength,ignoreLocation=_this$options2.ignoreLocation,allIndices=[],totalScore=0,hasMatches=!1;this.chunks.forEach(function(_ref2){var pattern=_ref2.pattern,alphabet=_ref2.alphabet,startIndex=_ref2.startIndex,_search=search(text,pattern,alphabet,{location:location+startIndex,distance,threshold,findAllMatches,minMatchCharLength,includeMatches,ignoreLocation}),isMatch=_search.isMatch,score=_search.score,indices=_search.indices;isMatch&&(hasMatches=!0),totalScore+=score,isMatch&&indices&&(allIndices=[].concat(_toConsumableArray(allIndices),_toConsumableArray(indices)))});var result={isMatch:hasMatches,score:hasMatches?totalScore/this.chunks.length:1};return hasMatches&&includeMatches&&(result.indices=allIndices),result}}]),BitapSearch}(),BaseMatch=function(){function BaseMatch(pattern){_classCallCheck(this,BaseMatch),this.pattern=pattern}return _createClass(BaseMatch,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(pattern){return getMatch(pattern,this.multiRegex)}},{key:"isSingleMatch",value:function(pattern){return getMatch(pattern,this.singleRegex)}}]),BaseMatch}();function getMatch(pattern,exp){var matches=pattern.match(exp);return matches?matches[1]:null}var ExactMatch=function(_BaseMatch){_inherits(ExactMatch,_BaseMatch);var _super=_createSuper(ExactMatch);function ExactMatch(pattern){return _classCallCheck(this,ExactMatch),_super.call(this,pattern)}return _createClass(ExactMatch,[{key:"search",value:function(text){var isMatch=text===this.pattern;return{isMatch,score:isMatch?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),ExactMatch}(BaseMatch),InverseExactMatch=function(_BaseMatch){_inherits(InverseExactMatch,_BaseMatch);var _super=_createSuper(InverseExactMatch);function InverseExactMatch(pattern){return _classCallCheck(this,InverseExactMatch),_super.call(this,pattern)}return _createClass(InverseExactMatch,[{key:"search",value:function(text){var index=text.indexOf(this.pattern),isMatch=index===-1;return{isMatch,score:isMatch?0:1,indices:[0,text.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),InverseExactMatch}(BaseMatch),PrefixExactMatch=function(_BaseMatch){_inherits(PrefixExactMatch,_BaseMatch);var _super=_createSuper(PrefixExactMatch);function PrefixExactMatch(pattern){return _classCallCheck(this,PrefixExactMatch),_super.call(this,pattern)}return _createClass(PrefixExactMatch,[{key:"search",value:function(text){var isMatch=text.startsWith(this.pattern);return{isMatch,score:isMatch?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),PrefixExactMatch}(BaseMatch),InversePrefixExactMatch=function(_BaseMatch){_inherits(InversePrefixExactMatch,_BaseMatch);var _super=_createSuper(InversePrefixExactMatch);function InversePrefixExactMatch(pattern){return _classCallCheck(this,InversePrefixExactMatch),_super.call(this,pattern)}return _createClass(InversePrefixExactMatch,[{key:"search",value:function(text){var isMatch=!text.startsWith(this.pattern);return{isMatch,score:isMatch?0:1,indices:[0,text.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),InversePrefixExactMatch}(BaseMatch),SuffixExactMatch=function(_BaseMatch){_inherits(SuffixExactMatch,_BaseMatch);var _super=_createSuper(SuffixExactMatch);function SuffixExactMatch(pattern){return _classCallCheck(this,SuffixExactMatch),_super.call(this,pattern)}return _createClass(SuffixExactMatch,[{key:"search",value:function(text){var isMatch=text.endsWith(this.pattern);return{isMatch,score:isMatch?0:1,indices:[text.length-this.pattern.length,text.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),SuffixExactMatch}(BaseMatch),InverseSuffixExactMatch=function(_BaseMatch){_inherits(InverseSuffixExactMatch,_BaseMatch);var _super=_createSuper(InverseSuffixExactMatch);function InverseSuffixExactMatch(pattern){return _classCallCheck(this,InverseSuffixExactMatch),_super.call(this,pattern)}return _createClass(InverseSuffixExactMatch,[{key:"search",value:function(text){var isMatch=!text.endsWith(this.pattern);return{isMatch,score:isMatch?0:1,indices:[0,text.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),InverseSuffixExactMatch}(BaseMatch),FuzzyMatch=function(_BaseMatch){_inherits(FuzzyMatch,_BaseMatch);var _super=_createSuper(FuzzyMatch);function FuzzyMatch(pattern){var _this,_ref=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_ref$location=_ref.location,location=_ref$location===void 0?Config.location:_ref$location,_ref$threshold=_ref.threshold,threshold=_ref$threshold===void 0?Config.threshold:_ref$threshold,_ref$distance=_ref.distance,distance=_ref$distance===void 0?Config.distance:_ref$distance,_ref$includeMatches=_ref.includeMatches,includeMatches=_ref$includeMatches===void 0?Config.includeMatches:_ref$includeMatches,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=_ref$findAllMatches===void 0?Config.findAllMatches:_ref$findAllMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=_ref$minMatchCharLeng===void 0?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$isCaseSensitive=_ref.isCaseSensitive,isCaseSensitive=_ref$isCaseSensitive===void 0?Config.isCaseSensitive:_ref$isCaseSensitive,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=_ref$ignoreLocation===void 0?Config.ignoreLocation:_ref$ignoreLocation;return _classCallCheck(this,FuzzyMatch),_this=_super.call(this,pattern),_this._bitapSearch=new BitapSearch(pattern,{location,threshold,distance,includeMatches,findAllMatches,minMatchCharLength,isCaseSensitive,ignoreLocation}),_this}return _createClass(FuzzyMatch,[{key:"search",value:function(text){return this._bitapSearch.searchIn(text)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),FuzzyMatch}(BaseMatch),IncludeMatch=function(_BaseMatch){_inherits(IncludeMatch,_BaseMatch);var _super=_createSuper(IncludeMatch);function IncludeMatch(pattern){return _classCallCheck(this,IncludeMatch),_super.call(this,pattern)}return _createClass(IncludeMatch,[{key:"search",value:function(text){for(var location=0,indices=[],index,patternLen=this.pattern.length;(index=text.indexOf(this.pattern,location))>-1;)location=index+patternLen,indices.push([index,location-1]);var isMatch=!!indices.length;return{isMatch,score:isMatch?0:1,indices}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),IncludeMatch}(BaseMatch),searchers=[ExactMatch,IncludeMatch,PrefixExactMatch,InversePrefixExactMatch,InverseSuffixExactMatch,SuffixExactMatch,InverseExactMatch,FuzzyMatch],searchersLen=searchers.length,SPACE_RE=/ +(?=([^"]*"[^"]*")*[^"]*$)/,OR_TOKEN="|";function parseQuery(pattern){var options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return pattern.split(OR_TOKEN).map(function(item){var query=item.trim().split(SPACE_RE).filter(function(item){return item&&!!item.trim()}),results=[];for(var i=0,len=query.length;i<len;i+=1){for(var queryItem=query[i],found=!1,idx=-1;!found&&++idx<searchersLen;){var searcher=searchers[idx],token=searcher.isMultiMatch(queryItem);token&&(results.push(new searcher(token,options)),found=!0)}if(found)continue;for(idx=-1;++idx<searchersLen;){var _searcher=searchers[idx],_token=_searcher.isSingleMatch(queryItem);if(_token){results.push(new _searcher(_token,options));break}}}return results})}var MultiMatchSet=new Set([FuzzyMatch.type,IncludeMatch.type]),ExtendedSearch=function(){function ExtendedSearch(pattern){var _ref=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_ref$isCaseSensitive=_ref.isCaseSensitive,isCaseSensitive=_ref$isCaseSensitive===void 0?Config.isCaseSensitive:_ref$isCaseSensitive,_ref$includeMatches=_ref.includeMatches,includeMatches=_ref$includeMatches===void 0?Config.includeMatches:_ref$includeMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=_ref$minMatchCharLeng===void 0?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=_ref$ignoreLocation===void 0?Config.ignoreLocation:_ref$ignoreLocation,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=_ref$findAllMatches===void 0?Config.findAllMatches:_ref$findAllMatches,_ref$location=_ref.location,location=_ref$location===void 0?Config.location:_ref$location,_ref$threshold=_ref.threshold,threshold=_ref$threshold===void 0?Config.threshold:_ref$threshold,_ref$distance=_ref.distance,distance=_ref$distance===void 0?Config.distance:_ref$distance;_classCallCheck(this,ExtendedSearch),this.query=null,this.options={isCaseSensitive,includeMatches,minMatchCharLength,findAllMatches,ignoreLocation,location,threshold,distance},this.pattern=isCaseSensitive?pattern:pattern.toLowerCase(),this.query=parseQuery(this.pattern,this.options)}return _createClass(ExtendedSearch,[{key:"searchIn",value:function(text){var query=this.query;if(!query)return{isMatch:!1,score:1};var _this$options=this.options,includeMatches=_this$options.includeMatches,isCaseSensitive=_this$options.isCaseSensitive;text=isCaseSensitive?text:text.toLowerCase();var numMatches=0,allIndices=[],totalScore=0;for(var i=0,qLen=query.length;i<qLen;i+=1){var searchers=query[i];allIndices.length=0,numMatches=0;for(var j=0,pLen=searchers.length;j<pLen;j+=1){var searcher=searchers[j],_searcher$search=searcher.search(text),isMatch=_searcher$search.isMatch,indices=_searcher$search.indices,score=_searcher$search.score;if(isMatch){if(numMatches+=1,totalScore+=score,includeMatches){var type=searcher.constructor.type;MultiMatchSet.has(type)?allIndices=[].concat(_toConsumableArray(allIndices),_toConsumableArray(indices)):allIndices.push(indices)}}else{totalScore=0,numMatches=0,allIndices.length=0;break}}if(numMatches){var result={isMatch:!0,score:totalScore/numMatches};return includeMatches&&(result.indices=allIndices),result}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(_,options){return options.useExtendedSearch}}]),ExtendedSearch}(),registeredSearchers=[];function register(){registeredSearchers.push.apply(registeredSearchers,arguments)}function createSearcher(pattern,options){for(var i=0,len=registeredSearchers.length;i<len;i+=1){var searcherClass=registeredSearchers[i];if(searcherClass.condition(pattern,options))return new searcherClass(pattern,options)}return new BitapSearch(pattern,options)}var LogicalOperator={AND:"$and",OR:"$or"},KeyType={PATH:"$path",PATTERN:"$val"},isExpression=function(query){return!!(query[LogicalOperator.AND]||query[LogicalOperator.OR])},isPath=function(query){return!!query[KeyType.PATH]},isLeaf=function(query){return!isArray(query)&&isObject(query)&&!isExpression(query)},convertToExplicit=function(query){return _defineProperty({},LogicalOperator.AND,Object.keys(query).map(function(key){return _defineProperty({},key,query[key])}))};function parse(query,options){var _ref3=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_ref3$auto=_ref3.auto,auto=_ref3$auto===void 0||_ref3$auto,next=function next(query){var keys=Object.keys(query),isQueryPath=isPath(query),key,obj;if(!isQueryPath&&keys.length>1&&!isExpression(query))return next(convertToExplicit(query));if(isLeaf(query)){key=isQueryPath?query[KeyType.PATH]:keys[0];var pattern=isQueryPath?query[KeyType.PATTERN]:query[key];if(!isString(pattern))throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(key));return obj={keyId:createKeyId(key),pattern},auto&&(obj.searcher=createSearcher(pattern,options)),obj}var node={children:[],operator:keys[0]};return keys.forEach(function(key){var value=query[key];isArray(value)&&value.forEach(function(item){node.children.push(next(item))})}),node};return isExpression(query)||(query=convertToExplicit(query)),next(query)}function computeScore$1(results,_ref){var _ref$ignoreFieldNorm=_ref.ignoreFieldNorm,ignoreFieldNorm=_ref$ignoreFieldNorm===void 0?Config.ignoreFieldNorm:_ref$ignoreFieldNorm;results.forEach(function(result){var totalScore=1;result.matches.forEach(function(_ref2){var key=_ref2.key,norm=_ref2.norm,score=_ref2.score,weight=key?key.weight:null;totalScore*=Math.pow(score===0&&weight?Number.EPSILON:score,(weight||1)*(ignoreFieldNorm?1:norm))}),result.score=totalScore})}function transformMatches(result,data){var matches=result.matches;if(data.matches=[],!isDefined(matches))return;matches.forEach(function(match){if(!isDefined(match.indices)||!match.indices.length)return;var indices=match.indices,value=match.value,obj={indices,value};match.key&&(obj.key=match.key.src),match.idx>-1&&(obj.refIndex=match.idx),data.matches.push(obj)})}function transformScore(result,data){data.score=result.score}function format(results,docs){var _ref=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_ref$includeMatches=_ref.includeMatches,includeMatches=_ref$includeMatches===void 0?Config.includeMatches:_ref$includeMatches,_ref$includeScore=_ref.includeScore,includeScore=_ref$includeScore===void 0?Config.includeScore:_ref$includeScore,transformers=[];return includeMatches&&transformers.push(transformMatches),includeScore&&transformers.push(transformScore),results.map(function(result){var data={item:docs[idx],refIndex:idx},idx=result.idx;return transformers.length&&transformers.forEach(function(transformer){transformer(result,data)}),data})}var Fuse=function(){function Fuse(docs){var options=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},index=arguments.length>2?arguments[2]:void 0;if(_classCallCheck(this,Fuse),this.options=_objectSpread2({},Config,{},options),this.options.useExtendedSearch&&!!0)throw new Error(EXTENDED_SEARCH_UNAVAILABLE);this._keyStore=new KeyStore(this.options.keys),this.setCollection(docs,index)}return _createClass(Fuse,[{key:"setCollection",value:function(docs,index){if(this._docs=docs,index&&!(index instanceof FuseIndex))throw new Error(INCORRECT_INDEX_TYPE);this._myIndex=index||createIndex(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function(doc){if(!isDefined(doc))return;this._docs.push(doc),this._myIndex.add(doc)}},{key:"remove",value:function(){var predicate=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},doc,results=[];for(var i=0,len=this._docs.length;i<len;i+=1)doc=this._docs[i],predicate(doc,i)&&(this.removeAt(i),i-=1,len-=1,results.push(doc));return results}},{key:"removeAt",value:function(idx){this._docs.splice(idx,1),this._myIndex.removeAt(idx)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(query){var _ref=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_ref$limit=_ref.limit,limit=_ref$limit===void 0?-1:_ref$limit,_this$options=this.options,includeMatches=_this$options.includeMatches,includeScore=_this$options.includeScore,shouldSort=_this$options.shouldSort,sortFn=_this$options.sortFn,ignoreFieldNorm=_this$options.ignoreFieldNorm,results=isString(query)?isString(this._docs[0])?this._searchStringList(query):this._searchObjectList(query):this._searchLogical(query);return computeScore$1(results,{ignoreFieldNorm}),shouldSort&&results.sort(sortFn),isNumber(limit)&&limit>-1&&(results=results.slice(0,limit)),format(results,this._docs,{includeMatches,includeScore})}},{key:"_searchStringList",value:function(query){var searcher=createSearcher(query,this.options),records=this._myIndex.records,results=[];return records.forEach(function(_ref2){var text=_ref2.v,idx=_ref2.i,norm=_ref2.n;if(!isDefined(text))return;var _searcher$searchIn=searcher.searchIn(text),isMatch=_searcher$searchIn.isMatch,score=_searcher$searchIn.score,indices=_searcher$searchIn.indices;isMatch&&results.push({item:text,idx,matches:[{score,value:text,norm,indices}]})}),results}},{key:"_searchLogical",value:function(query){var _this=this,expression=parse(query,this.options),evaluate=function evaluate(node,item,idx){if(!node.children){var keyId=node.keyId,searcher=node.searcher,res,matches=_this._findMatches({key:_this._keyStore.get(keyId),value:_this._myIndex.getValueForItemAtKeyId(item,keyId),searcher});return matches&&matches.length?[{idx,item,matches}]:[]}switch(node.operator){case LogicalOperator.AND:{res=[];for(var i=0,len=node.children.length;i<len;i+=1){var child=node.children[i],result=evaluate(child,item,idx);if(result.length)res.push.apply(res,_toConsumableArray(result));else return[]}return res}case LogicalOperator.OR:{var _res=[];for(var _i=0,_len=node.children.length;_i<_len;_i+=1){var _child=node.children[_i],_result=evaluate(_child,item,idx);if(_result.length){_res.push.apply(_res,_toConsumableArray(_result));break}}return _res}}},records=this._myIndex.records,resultMap={},results=[];return records.forEach(function(_ref3){var item=_ref3.$,idx=_ref3.i;if(isDefined(item)){var expResults=evaluate(expression,item,idx);expResults.length&&(resultMap[idx]||(resultMap[idx]={idx,item,matches:[]},results.push(resultMap[idx])),expResults.forEach(function(_ref4){var _resultMap$idx$matche,matches=_ref4.matches;(_resultMap$idx$matche=resultMap[idx].matches).push.apply(_resultMap$idx$matche,_toConsumableArray(matches))}))}}),results}},{key:"_searchObjectList",value:function(query){var _this2=this,searcher=createSearcher(query,this.options),_this$_myIndex=this._myIndex,keys=_this$_myIndex.keys,records=_this$_myIndex.records,results=[];return records.forEach(function(_ref5){var item=_ref5.$,idx=_ref5.i;if(!isDefined(item))return;var matches=[];keys.forEach(function(key,keyIndex){matches.push.apply(matches,_toConsumableArray(_this2._findMatches({key,value:item[keyIndex],searcher})))}),matches.length&&results.push({idx,item,matches})}),results}},{key:"_findMatches",value:function(_ref6){var key=_ref6.key,value=_ref6.value,searcher=_ref6.searcher;if(!isDefined(value))return[];var matches=[];if(isArray(value))value.forEach(function(_ref7){var text=_ref7.v,idx=_ref7.i,norm=_ref7.n;if(!isDefined(text))return;var _searcher$searchIn2=searcher.searchIn(text),isMatch=_searcher$searchIn2.isMatch,score=_searcher$searchIn2.score,indices=_searcher$searchIn2.indices;isMatch&&matches.push({score,key,value:text,idx,norm,indices})});else{var text=value.v,norm=value.n,_searcher$searchIn3=searcher.searchIn(text),isMatch=_searcher$searchIn3.isMatch,score=_searcher$searchIn3.score,indices=_searcher$searchIn3.indices;isMatch&&matches.push({score,key,value:text,norm,indices})}return matches}}]),Fuse}();return Fuse.version="6.4.6",Fuse.createIndex=createIndex,Fuse.parseIndex=parseIndex,Fuse.config=Config,Fuse.parseQuery=parse,register(ExtendedSearch),Fuse});const options={includeScore:!0,threshold:.24,useExtendedSearch:!0,ignoreLocation:!0,ignoreFieldNorm:!0,includeMatches:!0,findAllMatches:!0,tokenize:!0,keys:["title","name","canton","territoire","eglise","meta","permalink","NPA","region"]};async function fetchJSON(){const response=await fetch("index.json"),docs=await response.json();return docs}fetchJSON().then(docs=>{fuse=new Fuse(docs,options)});const input=document.querySelector("input");var resultsUI=document.querySelector(".search-results");input.addEventListener("keyup",function(){var result=fuse.search(this.value);console.log(result),clearResults();for(i in result){var i,listItem=document.createElement("li"),link=document.createElement("a");link.textContent=result[i].item.title+" ("+result[i].item.canton+")",link.setAttribute("href",result[i].item.permalink),listItem.appendChild(link),resultsUI.appendChild(listItem)}});var clearResults=function(){for(;resultsUI.firstChild;)resultsUI.removeChild(resultsUI.firstChild)};focusMethod=function(){document.getElementById("search").focus()},focusMethod()